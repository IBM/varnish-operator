# Operator Configuration

As the operator is packaged into [the Helm chart](https://helm.sh/docs/developing_charts/) the configuration is done by setting `values.yaml` overrides.

| Field                                           | Description                                                                                                                                                                                                                                                                                                                                          | Default                          |
|-------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|
| `affinity`                                      | [Affinity](https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#affinity-and-anti-affinity) settings for operator pods                                                                                                                                                                                                                 | `optional`                       |
| `container`                                     | Parameters of the Varnish operator container                                                                                                                                                                                                                                                                                                         |                                  |
| `container.image`                               | Path to the Varnish operator image being used                                                                                                                                                                                                                                                                                                        | Latest version available         |
| `container.imagePullPolicy`                     | Image pull policy for the containers.                                                                                                                                                                                                                                                                                                                | `Always`                         |
| `container.imagePullSecret`                     | The name of the image pull secret to use to pull the container image                                                                                                                                                                                                                                                                                 |                                  |
| `container.restartPolicy`                       | Restart policy for the containers.                                                                                                                                                                                                                                                                                                                   | `Always`                         |
| `container.resources`                           | [Resource requests and limits](https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/#resource-requests-and-limits-of-pod-and-container) for Varnish containers. The [field specs](https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.13/#resourcerequirements-v1-core) are the same as in the Pod spec |                                  |
| `container.resources.requests`                  | Resource requests                                                                                                                                                                                                                                                                                                                                    |                                  |
| `container.resources.requests.memory`           | Memory request                                                                                                                                                                                                                                                                                                                                       | `500m`                           |
| `container.resources.requests.cpu`              | CPU request                                                                                                                                                                                                                                                                                                                                          | `200Mi`                          |
| `container.resources.limits`                    | Resource limits                                                                                                                                                                                                                                                                                                                                      |                                  |
| `container.resources.limits.memory`             | Memory limit                                                                                                                                                                                                                                                                                                                                         | `500m`                           |
| `container.resources.limits.cpu`                | CPU limit                                                                                                                                                                                                                                                                                                                                            | `200Mi`                          |
| `logLevel`                                      | The minimum enabled logging level. Allowed values: `debug`, `info`, `warn`, `error`, `dpanic`, `panic`, `fatal`.                                                                                                                                                                                                                                     | `info`                           |
| `logFormat`                                     | Format of the logs. Can be `json` and `console`.                                                                                                                                                                                                                                                                                                     | `json`                           |
| `monitoring`                                    | The operator monitoring configuration object                                                                                                                                                                                                                                                                                                         |                                  |
| `monitoring.grafanaDashboard`                   | A dashboard that can be installed along with the operator and used in grafana. Installed as a ConfigMap.                                                                                                                                                                                                                                             |                                  |
| `monitoring.grafanaDashboard.enabled`           | Enable or disable the ConfigMap installation.                                                                                                                                                                                                                                                                                                        | `false`                          |
| `monitoring.grafanaDashboard.datasourceName`    | Name of the Grafana datasource the dashboard should use. Required.                                                                                                                                                                                                                                                                                   |                                  |
| `monitoring.grafanaDashboard.namespace`         | Namespace that the ConfigMap with the dashboard should be installed to.                                                                                                                                                                                                                                                                              | The same as the operator's       |
| `monitoring.grafanaDashboard.labels`            | ConfigMap labels. Can be used to for discovery by grafana. See the `.sidecar.dashboards.label` config parameter of [Grafana chart](https://github.com/helm/charts/tree/master/stable/grafana) for more details                                                                                                                                       | `{ grafana_dashboard: "1" }`     |
| `monitoring.prometheusServiceMonitor`           | The Prometheus ServiceMonitor that is preconfigured to monitors the operator pods.                                                                                                                                                                                                                                                                   |                                  |
| `monitoring.prometheusServiceMonitor.enabled`   | Enable or disable ServiceMontitor installation.                                                                                                                                                                                                                                                                                                      | `false`                          |
| `monitoring.prometheusServiceMonitor.namespace` | The namespace the it should be installed to.                                                                                                                                                                                                                                                                                                         | The same as the operator's       |
| `monitoring.prometheusServiceMonitor.labels`    | ServiceMonitor labels that will be used by Prometheus instance to discover this ServiceMonitor.                                                                                                                                                                                                                                                      | `{ operator: varnish_operator }` |
| `replicas`                                      | Number of Varnish operator pod replicas                                                                                                                                                                                                                                                                                                              | 1                                |
| `tolerations`                                   | Configuration that defines which node [taints](https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/) can the operator pods tolerate                                                                                                                                                                                               | `optional`                       |
